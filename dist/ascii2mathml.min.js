!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).ascii2mathml=e()}}(function(){return function o(c,a,u){function l(t,e){if(!a[t]){if(!c[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(s)return s(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=a[t]={exports:{}};c[t][0].call(i.exports,function(e){return l(c[t][1][e]||e)},i,i.exports,o,c,a,u)}return a[t].exports}for(var s="function"==typeof require&&require,e=0;e<u.length;e++)l(u[e]);return l}({1:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.ascii2mathml=E,r.default=void 0;var i,w=(i=e("./parser"))&&i.__esModule?i:{default:i};function S(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e){return(_="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}function E(r){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=e.annotate,n=void 0!==t&&t,i=e.bare,o=void 0!==i&&i,c=e.display,a=void 0===c?"inline":c,u=e.standalone,l=void 0!==u&&u,s=e.dir,f=void 0===s?"ltr":s,m=e.decimalMark,p=void 0===m?".":m,d=e.colSep,v=void 0===d?","===p?";":",":d,h=e.rowSep,g=void 0===h?";"===v?";;":";":h;if("object"===_(r))return function(e,t){return E(e,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?S(Object(r),!0).forEach(function(e){P(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},r,{},t))};if(o){if(l)throw new Error("Can't output a valid HTML without a root <math> element");if(a&&"inline"!==a.toLowerCase())throw new Error("Can't display block without root element.");if(f&&"ltr"!==f.toLowerCase())throw new Error("Can't have right-to-left direction without root element.")}var y,b=(0,w.default)({decimalMark:p,colSep:v,rowSep:g}),x=o?function(e){return e}:function(e){return"<math".concat("inline"!==a?' display="'.concat(a,'"'):"").concat("ltr"!==f?' dir="'.concat(f,'"'):"",">").concat(e,"</math>")};if(n){var O=b(r.trim(),""),j=O===w.default.getlastel(O)?O:"<mrow>".concat(O,"</mrow>");y=x("<semantics>".concat(j,'<annotation encoding="application/AsciiMath">').concat(r,"</annotation>")+"</semantics>")}else y=x(b(r.trim(),""));return l&&(y="<!DOCTYPE html><html><head><title>".concat(r,"</title></head>")+"<body>".concat(y,"</body></html>")),y}var o=E;r.default=o},{"./parser":3}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.accents=r.fonts=r.groupings=r.operators=r.identifiers=r.numbers=void 0;var n={};r.numbers=n;var i="[0-9\xb2\xb3\xb9\xbc-\xbe\u0660-\u0669\u06f0-\u06f9\u07c0-\u07c9\u0966-\u096f\u09e6-\u09ef\u09f4-\u09f9\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0b72-\u0b77\u0be6-\u0bf2\u0c66-\u0c6f\u0c78-\u0c7e\u0ce6-\u0cef\u0d66-\u0d75\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f33\u1040-\u1049\u1090-\u1099\u1369-\u137c\u16ee-\u16f0\u17e0-\u17e9\u17f0-\u17f9\u1810-\u1819\u1946-\u194f\u19d0-\u19da\u1a80-\u1a89\u1a90-\u1a99\u1b50-\u1b59\u1bb0-\u1bb9\u1c40-\u1c49\u1c50-\u1c59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u218b\u2460-\u249b\u24ea-\u24ff\u2776-\u2793\u2cfd\u3007\u3021-\u3029\u3038-\u303a\u3192-\u3195\u3220-\u3229\u3248-\u324f\u3251-\u325f\u3280-\u3289\u32b1-\u32bf\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341\u767e\u5343\u4e07\u5104\u5146\u4eac\u5793\ud855\udf71\u79ed\u7a63\u6e9d\u6f97\u6b63\u8f09\u5272\u5206\u5398\u6bdb\u7cf8\u5ffd\u5fae\u7e4a\u6c99\u5875\u57c3\ua620-\ua629\ua6e6-\ua6ef\ua830-\ua835\ua8d0-\ua8d9\ua900-\ua909\ua9d0-\ua9d9\uaa50-\uaa59\uabf0-\uabf9\uff10-\uff19]",o=new RegExp(i,"u");Object.defineProperties(n,{digitRange:{value:i},digitRE:{value:o},isdigit:{value:function(e){return e.match(o)}}});var c=["sin","cos","tan","csc","sec","cot","sinh","cosh","tanh","log","ln","det","dim","lim","mod","gcd","lcm","min","max"],a={Gamma:"\u0393",Delta:"\u0394",Theta:"\u0398",Lambda:"\u039b",Xi:"\u039e",Pi:"\u03a0",Sigma:"\u03a3",Phi:"\u03a6",Psi:"\u03a8",Omega:"\u03a9",alpha:"\u03b1",beta:"\u03b2",gamma:"\u03b3",delta:"\u03b4",epsilon:"\u025b",zeta:"\u03b6",eta:"\u03b7",theta:"\u03b8",iota:"\u03b9",kappa:"\u03ba",lambda:"\u03bb",mu:"\u03bc",nu:"\u03bd",xi:"\u03be",pi:"\u03c0",rho:"\u03c1",sigma:"\u03c3",tau:"\u03c4",upsilon:"\u03c5",phi:"\u03c6",chi:"\u03c7",psi:"\u03c8",omega:"\u03c9",oo:"\u221e","O/":"\u2205",CC:"\u2102",NN:"\u2115",QQ:"\u211a",RR:"\u211d",ZZ:"\u2124"};r.identifiers=a,c.forEach(function(e){a[e]=e}),Object.defineProperty(a,"contains",{value:function(e){return void 0!==a[e]}}),Object.defineProperty(a,"funs",{value:c}),Object.defineProperty(a,"isfun",{value:function(e){return 0<=c.indexOf(e)}});var u={"*":"\xb7","**":"\u2217","***":"\u22c6","//":"/","|":"|",":":":","'":"\u2032","''":"\u2033","'''":"\u2034","''''":"\u2057",xx:"\xd7","-:":"\xf7","|><":"\u22c9","><|":"\u22ca","|><|":"\u22c8","@":"\u2218","o+":"\u2295",ox:"\u2297","o.":"\u2299","!":"!",sum:"\u2211",prod:"\u220f","^^":"\u2227","^^^":"\u22c0",vv:"\u2228",vvv:"\u22c1",nn:"\u2229",nnn:"\u22c2",uu:"\u222a",uuu:"\u22c3",int:"\u222b",oint:"\u222e",dint:"\u222c","+-":"\xb1",del:"\u2202",grad:"\u2207",aleph:"\u2135","/_":"\u2220",diamond:"\u22c4",square:"\u25a1","|__":"\u230a","__|":"\u230b","|~":"\u2308","~|":"\u2309","=":"=","!=":"\u2260","<":"&lt;",">":"&gt;","<=":"\u2264",">=":"\u2265","-<":"\u227a","-<=":"\u2aaf",">-":"\u227b",">-=":"\u2ab0",in:"\u2208","!in":"\u2209",sub:"\u2282",sup:"\u2283",sube:"\u2286",supe:"\u2287","-=":"\u2261","==":"\u2261","~=":"\u2245","~~":"\u2248",prop:"\u221d","<-":"\u2190","->":"\u2192","=>":"\u21d2","<=>":"\u21d4","|->":"\u21a6",">->":"\u21a3","->>":"\u21a0",">->>":"\u2916",uarr:"\u2191",darr:"\u2193",larr:"\u2190",rarr:"\u2192",harr:"\u2194",lArr:"\u21d0",rArr:"\u21d2",hArr:"\u21d4",iff:"\u21d4",",":",",":.":"\u2234","...":"\u2026",cdots:"\u22ef",ddots:"\u22f1",vdots:"\u22ee",if:"if",otherwise:"otherwise",and:"and",or:"or",not:"\xac",AA:"\u2200",EE:"\u2203","_|_":"\u22a5",TT:"\u22a4","|--":"\u22a2","|==":"\u22a8"};r.operators=u,Object.defineProperty(u,"contains",{value:function(e){return void 0!==u[e]}}),Object.defineProperty(u,"get",{value:function(e){return u[e]||e}}),Object.defineProperty(u,"regexp",{value:new RegExp("(".concat(Object.keys(u).sort(function(e,t){return t.length-e.length}).map(function(e){return e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}).join("|"),"|[+-<=>|~\xac\xb1\xd7\xf7\u03d0\u03d1\u03d2\u03d5\u03f0\u03f1\u03f4\u03f5\u03f6\u0606\u0607\u0608\u2016\u2032\u2033\u2034\u2040\u2044\u2052\u2061-\u2064")+"\u207a-\u207e\u208a-\u208e\u2605\u2606\u2660\u2661\u2662\u2663\u266d\u266e\u266f\ufb29\uff61-\uff68\uff0b\uff1c\uff1d\uff1e\uff3c\uff3e\uff5c\uff5e\uffe2\uffe9\uffea\uffeb\uffec\u2200-\u22ff\u2a00-\u2aff\u27c0-\u27e5\u2980-\u2982\u2999-\u29ff\u2301-\u23ff\u25a0-\u25ff\u2b00-\u2bff\u2190-\u21ff\u27f0-\u27ff\u2900-\u297f\u20d0-\u20ef])")});var l={open:{"(:":"\u27e8","{:":""},close:{":)":"\u27e9",":}":""},complex:{abs:{open:"|",close:"|"},floor:{open:"\u230a",close:"\u230b"},ceil:{open:"\u2308",close:"\u2309"},norm:{open:"\u2225",close:"\u2225"}}};r.groupings=l,Object.defineProperty(l.open,"regexp",{value:/([[\u27e6\u27e8\u27ea\u27ec\u27ee\u2983\u2985\u2987\u2989\u298b\u298d\u298f\u2991\u2993\u2995\u2997]|[({]:?)/}),Object.defineProperty(l.close,"regexp",{value:/([\]\u27e7\u27e9\u27eb\u27ed\u27ef\u2984\u2986\u2988\u298a\u298c\u298e\u2990\u2992\u2994\u2996\u2998]|:?[)}])/}),Object.defineProperty(l.open,"get",{value:function(e){var t=l.open[e];return"string"==typeof t?t:e}}),Object.defineProperty(l.close,"get",{value:function(e){var t=l.close[e];return"string"==typeof t?t:e}}),Object.defineProperty(l.complex,"contains",{value:function(e){return 0<=Object.keys(l.complex).indexOf(e)}}),Object.defineProperty(l.complex,"get",{value:function(e){return l.complex[e]}}),Object.freeze(l.open),Object.freeze(l.close),Object.freeze(l.complex);var s={rm:"normal",bf:"bold",it:"italic",bb:"double-struck",cc:"script",tt:"monospace",fr:"fraktur",sf:"sans-serif"};r.fonts=s,Object.defineProperty(s,"get",{value:function(e){return s[e]}}),Object.defineProperty(s,"regexp",{value:new RegExp("(".concat(Object.keys(s).join("|"),")"))});var f={hat:{type:"over",accent:"^"},bar:{type:"over",accent:"\u203e"},ul:{type:"under",accent:"_"},vec:{type:"over",accent:"\u2192"},dot:{type:"over",accent:"\u22c5"},ddot:{type:"over",accent:"\u22c5\u22c5"},tilde:{type:"over",accent:"\u02dc"},cancel:{type:"enclose",attrs:{notation:"updiagonalstrike"}}};r.accents=f,Object.defineProperty(f,"contains",{value:function(e){return 0<=Object.keys(f).indexOf(e)}}),Object.defineProperty(f,"get",{value:function(e){return f[e]}}),Object.defineProperty(f,"regexp",{value:new RegExp("(".concat(Object.keys(f).join("|"),")"))})},{}],3:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,be=(i=e("./syntax"))&&i.__esModule?i:{default:i},xe=e("./lexicon");function Oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var c,a=e[Symbol.iterator]();!(n=(c=a.next()).done)&&(r.push(c.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}function je(i){return function t(r,n){if("object"===o(r))return function(e){return t(e,r)};if("object"!==o(n))return"<".concat(i,">").concat(r,"</").concat(i,">");var e=Object.keys(n).map(function(e){return"".concat(e,'="').concat(n[e],'"')}).join(" ");return"<".concat(i," ").concat(e,">").concat(r,"</").concat(i,">")}}var we=je("mi"),Se=je("mn"),Pe=je("mo"),_e=je("mfrac"),Ee=je("msup"),ke=je("msub"),We=je("msubsup"),Re=je("munder"),Ae=je("mover"),Le=je("munderover"),Me=je("menclose"),Ce=je("mrow"),Ge=je("msqrt"),Ne=je("mroot"),ze=je("mfenced"),$e=je("mtable"),qe=je("mtr"),De=je("mtd");function c(fe){var e="."===fe.decimalMark?"\\.":fe.decimalMark,me=new RegExp("^".concat(xe.numbers.digitRange,"+(").concat(e).concat(xe.numbers.digitRange,"+)?")),pe=t(fe.colSep),de=t(fe.rowSep),ve=t("\n");function t(a){return function(e){for(var t=[],r=0,n=0,i=0;i<e.length;i+=1){var o=e.slice(i),c=e[i];o.startsWith(a)&&!e.slice(0,i).match(/\\(\\{2})*$/)?0===r&&(t.push(e.slice(n,i)),n=i+a.length):c.match(xe.groupings.open.regexp)?r+=1:c.match(xe.groupings.close.regexp)&&--r}return t.push(e.slice(n)),t}}var r=function e(t,r,n,i){if(!t)return r;if(t.match(/^\s/)){if(t.match(/^\s+(\/[^/]|^[^^]|_[^_|])/))return e(t.trim(),r,!0);var o=t.match(/^ +/),c=o?o[0].length:0;if(1<c){var a='<mspace width="'.concat(c-1,'ex" />');return e(t.trim(),r+a,!0)}return e(t.trim(),r,!0)}var u=Oe(ge(t,i),2),l=u[0],s=u[1];if((s&&s.trimLeft().startsWith("/")||s.trimLeft().startsWith("./"))&&!s.trimLeft().match(/^\.?\/\//)){var f=function e(t,r){var n=r.trim().startsWith("./");var i=r.trim().slice(n?2:1);var o;var c;if(i.startsWith(" ")){var a=i.trim().split(" ");o=he(a[0]),c=i.trimLeft().slice(a[0].length+1)}else{var u=ge(i),l=Oe(u,2);o=l[0],c=l[1]}o=o||Ce("");var s=_e(Ie(t)+Ie(o),n&&{bevelled:!0});if(c&&c.trim().startsWith("/")||c.trim().startsWith("./"))return e(s,c);return[s,c]}(l,s),m=Oe(f,2);l=m[0],s=m[1]}return e(s,r+l,!1)};function he(e){if(0===e.trim().length)return"";var t=r(e,"",!1,!0);return t===a(t)?t:Ce(t)}function ge(e,t,r){if(!e)return["",""];var n,i,o,c,a,u,l,s=e[0],f=e.slice(1),m=s+(f.match(/^[A-Za-z]+/)||"");if(e.startsWith("sqrt")){var p=ge(e.slice(4).trim(),t);n=Ge(p[0]?Ie(p[0]):Ce("")),i=Oe(p,2)[1]}else if(e.startsWith("root")){var d=ge(e.slice(4).trimLeft(),t),v=d[0]?Ie(d[0]):Ce(""),h=ge(d[1].trimLeft(),t),g=h[0]?Ie(h[0]):Ce("");n=Ne(g+v),i=Oe(h,2)[1]}else if(e.startsWith("binom")){var y=Oe(be.default.splitNextGroup(e),5),b=y[2],x=y[4],O=Oe(pe(b),2),j=O[0],w=O[1],S=he(j.trim())||Ce(""),P=he(w.trim())||Ce("");n=ze(_e(S+P,{linethickness:0}),{open:"(",close:")"}),i=x}else if("\\"===s&&1<e.length)if(e[1].match(/[([]/)){var _=function(e){var t=e[0],r=t;"("===t?r=")":"["===t&&(r="]");for(var n=0,i=0,o=0;o<e.length;o+=1){var c=e[o];if(i+=1,c===r){if(0===--n)break}else c===t&&(n+=1)}return i}(f);n=Pe(e.slice(2,_)),i=e.slice(_+1)}else n=Pe(e[1]),i=e.slice(2);else if(xe.accents.contains(m)){var E=xe.accents.get(m),k=e.slice(m.length).trimLeft(),W=k.match(/^\s*\(?([ij])\)?/),R=ge(k);switch(E.type){case"over":if(W)n=Ae(we("i"===W[1]?"\u0131":"\u0237")+Pe(E.accent,{accent:!0})),i=k.slice(W[0].length);else n=Ae(Ie(R[0])+Pe(E.accent,{accent:!0})),i=Oe(R,2)[1];break;case"under":n=Re(Ie(R[0])+Pe(E.accent)),i=Oe(R,2)[1];break;case"enclose":n=Me(Ie(R[0]),E.attrs),i=Oe(R,2)[1];break;default:throw new Error("Invalid config for accent ".concat(m))}}else if(be.default.isfontCommand(e)){var A=be.default.splitfont(e);n=je(A.tagname)(A.text,A.font&&{mathvariant:A.font}),i=A.rest}else if(xe.groupings.complex.contains(m)){var L=xe.groupings.complex.get(m),M=ge(e.slice(m.length).trimLeft());n=ze(Ie(M[0]),L),i=Oe(M,2)[1]}else if(be.default.isgroupStart(e)||be.default.isvertGroupStart(e)){var C=Oe(be.default.isgroupStart(e)?be.default.splitNextGroup(e):be.default.splitNextVert(e),5),G=C[1],N=C[2],z=C[3],$=C[4];i=xe.groupings.open.get($);var q=1<(l=ve(N)).length?l:de(N);if(be.default.ismatrixInterior(N.trim(),fe.colSep,fe.rowSep)){N.trim().endsWith(fe.colSep)&&(N=N.trimRight().slice(0,-1));var D=(c=N,a="{"===G&&""===z&&{columnalign:"center left"},u=function(){var e=pe(c);return 1<e.length?e:ve(c)}().map(function(e){return e.trim().slice(1,-1)}),$e(u.map(function(e){return function e(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";if(!t||0===t.length)return qe(r);var n=ye(t.trim(),""),i=Oe(n,2),o=i[0],c=i[1];return e(c.trim(),r+o)}(e)}).join(""),a));n=ze(D,{open:G,close:z})}else if(1<q.length){var I=q.map(pe);1===Ue(I).length&&Ue(I)[0].match(/^\s*$/)&&(I=I.slice(0,-1));var T=I.map(function(e){return qe(e.map(function(e){return De(he(e))}).join(""))}).join("");n=ze($e(T),{open:G,close:z})}else{var U=pe(N).map(he).join(""),F={open:G,close:z};","!==fe.colSep&&(F.separators=fe.colSep),n=ze(U,F)}}else if(!t&&be.default.isgroupable(e,fe)){var Z=function e(t){var r=new RegExp("(\\s|".concat(fe.colSep,"|").concat(fe.rowSep,"|$)"));var n=t.match(r);var i=t.slice(0,n.index);var o=n[0];var c=t.slice(n.index+1);var a=i;var u=o+c;if(!be.default.isgroupStart(c.trim())&&be.default.endsInFunc(i)){var l=e(c);a+=o+l[0];var s=Oe(l,2);u=s[1]}else if(i.match(/root$/)){var f=e(c),m=e(f[1].trimLeft());a+="".concat(o+f[0]," ").concat(m[0]),u=o+m[1]}return[a,u]}(e);n=he(Z[0]),i=Oe(Z,2)[1]}else if(xe.numbers.isdigit(s)){var Q=e.match(me)[0];n=Se(Q),i=f.slice(Q.length-1)}else if(e.match(/^#`[^`]+`/)){var V=e.match(/^#`([^`]+)`/)[1];n=Se(V),i=e.slice(V.length+3)}else if(e.match(new RegExp("^".concat(xe.operators.regexp.source)))&&!xe.identifiers.contains(m)){var H=Oe(be.default.splitNextOperator(e),2),X=H[0],Y=H[1],B=e.startsWith("'"),J=Te(["\u2202","\u2207"],X),K=Te(["|"],X),ee=e.startsWith("| "),te={};B&&(te.lspace=0,te.rspace=0),J&&(te.rspace=0),K&&(te.stretchy=!0),ee&&(te.lspace="veryverythickmathspace",te.rspace="veryverythickmathspace"),n=Pe(X,(o=te,!(0===Object.keys(o).length)&&te)),i=Y}else if(xe.identifiers.contains(m)){var re=xe.identifiers[m];n=re.match(/[\u0391-\u03A9\u2100-\u214F\u2200-\u22FF]/)?we(re,{mathvariant:"normal"}):we(re),i=f.slice(m.length-1)}else i="O"===s&&"/"===f[0]?(n=we(xe.identifiers["O/"],{mathvariant:"normal"}),f.slice(1)):(n=we(s),f);if(i&&i.trimLeft().match(/\.?[\^_]/))if(r&&r.match(/m(sup|over)/)||!i.trim().startsWith("_")||!(i.trim().length<=1)&&i.trim()[1].match(/[|_]/))if("mover"!==r&&i.trim().startsWith("._")&&(i.trim().length<=2||!i.trim()[2].match(/[|_]/))){var ne=function(e,t){var r,n=ge(t.trim().slice(2).trim(),!0,"munder"),i=n[0]?Ie(n[0]):Ce(""),o=n[1],c=o.match(/^(\.?\^)[^^]/);if(c){var a=ge(o.trim().slice(c[1].length).trim(),!0),u=a[0]?Ie(a[0]):Ce("");r=Le(e+i+u);var l=Oe(a,2);o=l[1]}else r=Re(e+i);return[r,o]}(n,i),ie=Oe(ne,2);n=ie[0],i=ie[1]}else if(r&&r.match(/m(sub|under)/)||!i.trim().startsWith("^")||!(i.trim().length<=1||"^"!==i.trim()[1])){if("munder"!==r&&i.trim().startsWith(".^")&&(i.trim().length<=2||"^"!==i.trim()[2])){var oe=function(e,t){var r,n=ge(t.trim().slice(2).trim(),!0,"mover"),i=n[0]?Ie(n[0]):Ce(""),o=n[1],c=o.match(/^(\.?_)[^_|]/);if(c){var a=ge(o.trim().slice(c[1].length).trim(),!0),u=a[0]?Ie(a[0]):Ce("");r=Le(e+u+i);var l=Oe(a,2);o=l[1]}else r=Ae(e+i);return[r,o]}(n,i),ce=Oe(oe,2);n=ce[0],i=ce[1]}}else{var ae=function(e,t){var r,n=ge(t.trim().slice(1).trim(),!0,"msup"),i=n[0]?Ie(n[0]):Ce(""),o=n[1];if(o.trim().startsWith("_")&&(o.trim().length<=1||!o.trim()[1].match(/[|_]/))){var c=ge(o.trim().slice(1).trim(),!0),a=c[0]?Ie(c[0]):Ce(""),u=be.default.shouldGoUnder(e)?Le:We;r=u(e+a+i);var l=Oe(c,2);o=l[1]}else{var s=be.default.shouldGoUnder(e)?Ae:Ee;r=s(e+i)}return[r,o]}(n,i),ue=Oe(ae,2);n=ue[0],i=ue[1]}else{var le=function(e,t){var r,n=ge(t.trim().slice(1).trim(),!0,"msub"),i=n[0]?Ie(n[0]):Ce(""),o=n[1];if(o&&o.trim().startsWith("^")&&(o.trim().length<=1||"^"!==!o.trim()[1])){var c=ge(o.trim().slice(1).trim(),!0),a=c[0]?Ie(c[0]):Ce(""),u=be.default.shouldGoUnder(e)?Le:We;r=u(e+i+a);var l=Oe(c,2);o=l[1]}else{var s=be.default.shouldGoUnder(e)?Re:ke;r=s(e+i)}return[r,o]}(n,i),se=Oe(le,2);n=se[0],i=se[1]}return[n,i]}function ye(e,t){if(!e||0===e.length)return[De(t),""];if(e[0]===fe.colSep)return[De(t),e.slice(1).trim()];var r=Oe(ge(e),2),n=r[0];return ye(r[1].trim(),t+n)}return r}function Ie(e){var t,r,n=e.replace(/^<mfenced[^>]*>/,"").replace(/<\/mfenced>$/,"");return(r=a(t=n),[t.slice(0,t.lastIndexOf(r)),r])[1]===n?n:Ce(n)}function a(e){var t=e.match(/<\/(m[a-z]+)>$/);if(!t){var r=e.match(/<mspace\s*([a-z]+="[a-z]")*\s*\?>/);if(r){var n=r.match[0].length;return e.slice(n)}return""}for(var i=t[1],o=e.length-(i.length+3),c=0;0<=o;--o){if(e.slice(o).startsWith("<".concat(i))){if(0===c)break;--c}e.slice(o-2).startsWith("</".concat(i))&&(c+=1)}return e.slice(o)}function Te(e,t){return 0<=e.indexOf(t)}function Ue(e){return e.slice(-1)[0]}c.getlastel=a;var u=c;r.default=u},{"./lexicon":2,"./syntax":4}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var m=e("./lexicon");function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var c,a=e[Symbol.iterator]();!(n=(c=a.next()).done)&&(r.push(c.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e){var t=new RegExp("^".concat(m.groupings.open.regexp.source));return e.match(t)}var n=new RegExp("(".concat(m.identifiers.funs.concat(Object.keys(m.accents)).concat(["sqrt"]).sort(function(e,t){return e.length-t.length}).join("|"),")$"));function d(e){for(var t,r,n,i,o=new RegExp("^".concat(m.groupings.open.regexp.source)),c=new RegExp("^".concat(m.groupings.close.regexp.source)),a=0,u=0;u<e.length;){var l=e.slice(u),s=l.match(o),f=l.match(c);if(s){if("number"!=typeof t)t=u,n=p(s,1)[0];a+=1,u+=s[0].length}else if(f){if(0===--a){r=u+((i=p(f,1)[0]).length-1);break}u+=f[0].length}else u+=1}return n?[0===t?"":e.slice(0,t),m.groupings.open.get(n),e.slice(t+n.length,i?r-(i.length-1):e.length),i?m.groupings.close.get(i):"",r?e.slice(r+1):""]:null}function o(e){var t,r,n,i=e.indexOf("|"),o=i+1,c=e.slice(i+1),a=c.startsWith("|"),u=a?/\|\|/:/\|/;if(a&&(c=c.slice(1),o+=1),-1===c.indexOf("|"))return null;if(c.match(/^\.?[_^]/))return null;for(;0<c.length;){var l=d(c),s=l?l[0]:c,f=l?l[4]:"",m=u.exec(s);if(m)return t=i,r=o+m.index,n=a,[0===t?"":e.slice(0,t),n?"\u2016":"|",e.slice(t+(n?2:1),r),n?"\u2016":"|",e.slice(r+(n?2:1))];o+=l.slice(0,-1).map(v("length")).reduce(h),""===l[1]?o+=2:"\u2329"===l[1]&&(o+=1),""===l[3]?o+=2:"\u232a"===l[3]&&(o+=1),c=f}return null}function v(t){return function(e){return e[t]}}function h(e,t){return e+t}function c(e){var t=new RegExp("^(".concat(m.fonts.regexp.source," ?)?").concat(e));return function(e){return t.exec(e)}}var u=c("(`)\\w+`"),l=c('(")');var a=["<mi>lim</mi>","<mo>\u2211</mo>","<mo>\u220f</mo>"];var s={endsInFunc:function(e){return e.match(n)},isgroupStart:i,isgroupable:function(e,t){var r=new RegExp("^[0-9A-Za-z+\\-!]{2,}(\\s|".concat(t.colSep,"|").concat(t.rowSep,")"));return e.match(r)},isvertGroupStart:function(e){if(!e.startsWith("|"))return!1;var t=o(e);return t&&""===t[0]},splitNextGroup:d,splitNextVert:o,splitNextOperator:function(e){var t=new RegExp("^".concat(m.operators.regexp.source)).exec(e)[0];return[m.operators.get(t),e.slice(t.length)]},ismatrixInterior:function(e,t,r){if(!i(e))return!1;var n=d(e)[4];if(!(n.trim().startsWith(t)||n.match(/^\s*\n/)&&i(n.trim())))return!1;for(;n&&n.trim();){if((n=p(d(n)||[],5)[4])&&(n.startsWith(r)||n.match(/^\s*\n/)))return!1}return!0},isfontCommand:function(e){return u(e)||l(e)},splitfont:function(e){var t=u(e)||l(e),r=t&&t[2],n=t&&t[3],i="";'"'===n?i="mtext":"`"===n&&(i="mi");var o=e.indexOf(n),c=o+1+e.slice(o+1).indexOf(n),a=0<o?m.fonts.get(r):"";return{tagname:i,text:e.slice(o+1,c),font:a,rest:e.slice(c+1)}},shouldGoUnder:function(e){return 0<=a.indexOf(e)}};r.default=s},{"./lexicon":2}]},{},[1])(1)});
